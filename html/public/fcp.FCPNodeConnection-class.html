<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>fcp.FCPNodeConnection</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css"></link>
</head>
<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">

<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" align="right" width="100%">
      <table border="0" cellpadding="0" cellspacing="0">
      <tr><th class="navbar" align="center">
        <p class="nomargin">
          PyFCP&nbsp;-&nbsp;Python&nbsp;client&nbsp;interface&nbsp;to&nbsp;Freenet&nbsp;FCP
      </p></th></tr></table>
    </th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <font size="-1"><b class="breadcrumbs">
        <a href="fcp-module.html">Module&nbsp;fcp</a> ::
        Class&nbsp;FCPNodeConnection
      </b></font></br>
    </td>
    <td><table cellpadding="0" cellspacing="0">
      <tr><td align="right"><font size="-2">[<a href="../private/fcp.FCPNodeConnection-class.html">show&nbsp;private</a>&nbsp;|&nbsp;hide&nbsp;private]</font></td></tr>
      <tr><td align="right"><font size="-2">[<a href="frames.html"target="_top">frames</a>&nbsp;|&nbsp;<a href="fcp.FCPNodeConnection-class.html" target="_top">no&nbsp;frames</a>]</font></td></tr>
    </table></td>
</tr></table>

<!-- =========== START OF CLASS DESCRIPTION =========== -->
<h2 class="class">Class FCPNodeConnection</h2>

<hr/>

<pre class="literalblock">
Represents an interface to a freenet node via its FCP port,
and exposes primitives for the basic genkey, get, put and putdir
operations.

Only one instance of FCPNodeConnection is needed across an entire
running client application, because its methods are quite thread-safe.
Creating 2 or more instances is a waste of resources.

Clients, when invoking methods, have several options regarding flow
control and event notification:

    - synchronous call (the default). Here, no pending status messages
      will ever be seen, and the call will only control when it has
      completed (successfully, or otherwise)
    
    - asynchronous call - this is invoked by passing the keyword argument
      'async=True' to any of the main primitives. When a primitive is invoked
      asynchronously, it will return a 'job ticket object' immediately. This
      job ticket has methods for polling for job completion, or blocking
      awaiting completion
    
    - setting a callback. You can pass to any of the primitives a
      'callback=somefunc' keyword arg, where 'somefunc' is a callable object
       conforming to::
           
           def somefunc(status, value):
               ...
      
      The callback function will be invoked when a primitive succeeds or fails,
      as well as when a pending message is received from the node.
      
      The 'status' argument passed will be one of:
          - 'successful' - the primitive succeeded, and 'value' will contain
            the result of the primitive
          - 'pending' - the primitive is still executing, and 'value' will
            contain the raw pending message sent back from the node, as a
            dict
          - 'failed' - the primitive failed, and as with 'pending', the
            argument 'value' contains a dict containing the message fields
            sent back from the node

      Note that callbacks can be set in both synchronous and asynchronous
      calling modes.
</pre>
<hr/>


<!-- =========== START OF METHOD SUMMARY =========== -->
<table class="summary" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="summary">
  <th colspan="2">Method Summary</th></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="fcp.FCPNodeConnection-class.html#__init__" class="summary-sig-name"><code>__init__</code></a>(<span class=summary-sig-arg>self</span>,
          <span class="summary-sig-kwarg">**kw</span>)</span></code>
<br />
Create a connection object</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="fcp.FCPNodeConnection-class.html#__del__" class="summary-sig-name"><code>__del__</code></a>(<span class=summary-sig-arg>self</span>)</span></code>
<br />
object is getting cleaned up, so disconnect</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="fcp.FCPNodeConnection-class.html#genkey" class="summary-sig-name"><code>genkey</code></a>(<span class=summary-sig-arg>self</span>,
          <span class="summary-sig-kwarg">**kw</span>)</span></code>
<br />
Generates and returns an SSK keypair</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="fcp.FCPNodeConnection-class.html#get" class="summary-sig-name"><code>get</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>uri</span>,
          <span class="summary-sig-kwarg">**kw</span>)</span></code>
<br />
Does a direct get of a key</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="fcp.FCPNodeConnection-class.html#put" class="summary-sig-name"><code>put</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>uri</span>,
          <span class="summary-sig-kwarg">**kw</span>)</span></code>
<br />
Inserts a key</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="fcp.FCPNodeConnection-class.html#putdir" class="summary-sig-name"><code>putdir</code></a>(<span class=summary-sig-arg>self</span>,
          <span class=summary-sig-arg>uri</span>,
          <span class="summary-sig-kwarg">**kw</span>)</span></code>
<br />
Inserts a freesite</td></tr>
<tr><td align="right" valign="top" width="15%"><font size="-1">&nbsp;</font></td>
  <td><code><span class="summary-sig"><a href="fcp.FCPNodeConnection-class.html#shutdown" class="summary-sig-name"><code>shutdown</code></a>(<span class=summary-sig-arg>self</span>)</span></code>
<br />
Terminates the manager thread</td></tr>
</table><br />


<!-- =========== START OF METHOD DETAILS =========== -->
<table class="details" border="1" cellpadding="3" cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="details">
  <th colspan="2">Method Details</th></tr>
</table>

<a name="__init__"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">__init__</span>(<span class=sig-arg>self</span>,
          <span class="sig-kwarg">**kw</span>)</span>
    <br /><i>(Constructor)</i>
  </h3>
  <p>Create a connection object</p>
  Arguments:
  <ul>
    <li>
      clientName - name of client to use with reqs, defaults to 
      random
    </li>
    <li>
      host - hostname, defaults to defaultFCPHost
    </li>
    <li>
      port - port number, defaults to defaultFCPPort
    </li>
    <li>
      logfile - a pathname or writable file object, to which log 
      messages should be written, defaults to stdout
    </li>
    <li>
      verbosity - how detailed the log messages should be, defaults to 
      0 (silence)
    </li>
  </ul>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>

<a name="__del__"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">__del__</span>(<span class=sig-arg>self</span>)</span>
    <br /><i>(Destructor)</i>
  </h3>
  object is getting cleaned up, so disconnect
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>

<a name="genkey"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">genkey</span>(<span class=sig-arg>self</span>,
          <span class="sig-kwarg">**kw</span>)</span>
  </h3>
  <p>Generates and returns an SSK keypair</p>
  Keywords:
  <ul>
    <li>
      async - whether to do this call asynchronously, and return a 
      JobTicket object
    </li>
    <li>
      callback - if given, this should be a callable which accepts 2 
      arguments:
      <ul>
        <li>
          status - will be one of 'successful', 'failed' or 
          'pending'
        </li>
        <li>
          value - depends on status:
          <ul>
            <li>
              if status is 'successful', this will contain the value 
              returned from the command
            </li>
            <li>
              if status is 'failed' or 'pending', this will contain a 
              dict containing the response from node
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>

<a name="get"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">get</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>uri</span>,
          <span class="sig-kwarg">**kw</span>)</span>
  </h3>
  <p>Does a direct get of a key</p>
  Keywords:
  <ul>
    <li>
      async - whether to return immediately with a job ticket object, 
      default False (wait for completion)
    </li>
    <li>
      dsnly - whether to only check local datastore
    </li>
    <li>
      ignoreds - don't check local datastore
    </li>
    <li>
      file - if given, this is a pathname to which to store the 
      retrieved key
    </li>
    <li>
      nodata - if true, no data will be returned. This can be a useful 
      test of whether a key is retrievable, without having to consume 
      resources by retrieving it
    </li>
  </ul>
  Returns a 2-tuple, depending on keyword args:
  <ul>
    <li>
      if 'file' is given, returns (mimetype, pathname) if key is 
      returned
    </li>
    <li>
      if 'file' is not given, returns (mimetype, data) if key is 
      returned
    </li>
    <li>
      if 'dontReturnData' is true, returns (mimetype, 1) if key is 
      returned
    </li>
  </ul>
  If key is not found, raises an exception
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>

<a name="put"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">put</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>uri</span>=<span class=sig-default>'CHK&#64;'</span>,
          <span class="sig-kwarg">**kw</span>)</span>
  </h3>
  <p>Inserts a key</p>
  Arguments:
  <ul>
    <li>
      uri - uri under which to insert the key
    </li>
  </ul>
  Keywords - you must specify one of the following to choose an insert 
  mode:
  <ul>
    <li>
      file - path of file from which to read the key data
    </li>
    <li>
      data - the raw data of the key as string
    </li>
    <li>
      dir - the directory to insert, for freesite insertion
    </li>
    <li>
      redirect - the target URI to redirect to
    </li>
  </ul>
  Keywords for 'dir' mode:
  <ul>
    <li>
      name - name of the freesite, the 'sitename' in 
      SSK&#64;privkey/sitename'
    </li>
    <li>
      usk - whether to insert as a USK 
      (USK&#64;privkey/sitename/version/), default False
    </li>
    <li>
      version - valid if usk is true, default 0
    </li>
  </ul>
  Keywords for 'file' and 'data' modes:
  <ul>
    <li>
      chkonly - only generate CHK, don't insert - default false
    </li>
    <li>
      dontcompress - do not compress on insert - default false
    </li>
  </ul>
  Keywords for 'file', 'data' and 'redirect' modes:
  <ul>
    <li>
      mimetype - the mime type, default text/plain
    </li>
  </ul>
  Keywords valid for all modes:
  <ul>
    <li>
      maxretries - maximum number of retries, default 3
    </li>
    <li>
      priority - default 1
    </li>
    <li>
      async - whether to do the job asynchronously, returning a job 
      ticket object (default False)
    </li>
  </ul>
  Notes:
  <ul>
    <li>
      exactly one of 'file', 'data' or 'dir' keyword arguments must be 
      present
    </li>
  </ul>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>

<a name="putdir"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">putdir</span>(<span class=sig-arg>self</span>,
          <span class=sig-arg>uri</span>,
          <span class="sig-kwarg">**kw</span>)</span>
  </h3>
  <p>Inserts a freesite</p>
  Arguments:
  <ul>
    <li>
      uri - uri under which to insert the key
    </li>
  </ul>
  Keywords:
  <ul>
    <li>
      dir - the directory to insert - mandatory, no default. This 
      directory must contain a toplevel index.html file
    </li>
    <li>
      name - the name of the freesite, defaults to 'freesite'
    </li>
    <li>
      usk - set to True to insert as USK (Default false)
    </li>
    <li>
      version - the USK version number, default 0
    </li>
    <li>
      maxretries - maximum number of retries, default 3
    </li>
    <li>
      priority - default 1
    </li>
    <li>
      async - default False - if True, return a job ticket
    </li>
  </ul>
  Returns:
  <ul>
    <li>
      the URI under which the freesite can be retrieved
    </li>
  </ul>
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>

<a name="shutdown"></a>
<table width="100%" class="func-details" bgcolor="#e0e0e0"><tr><td>
  <h3><span class="sig"><span class="sig-name">shutdown</span>(<span class=sig-arg>self</span>)</span>
  </h3>
  <p>Terminates the manager thread</p>
  You should explicitly shutdown any existing nodes before exiting 
  your client application
  <dl><dt></dt><dd>
  </dd></dl>
</td></tr></table>
<br />


<!-- =========== START OF NAVBAR =========== -->
<table class="navbar" border="0" width="100%" cellpadding="0" bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="center">
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="trees.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="indices.html">Index</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar">&nbsp;&nbsp;&nbsp;<a class="navbar" href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>
    <th class="navbar" align="right" width="100%">
      <table border="0" cellpadding="0" cellspacing="0">
      <tr><th class="navbar" align="center">
        <p class="nomargin">
          PyFCP&nbsp;-&nbsp;Python&nbsp;client&nbsp;interface&nbsp;to&nbsp;Freenet&nbsp;FCP
      </p></th></tr></table>
    </th>
  </tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
  <tr>
    <td align="left"><font size="-2">Generated by Epydoc 2.1 on Fri May 12 18:42:19 2006</font></td>
    <td align="right"><a href="http://epydoc.sourceforge.net"
                      ><font size="-2">http://epydoc.sf.net</font></a></td>
  </tr>
</table>
</body>
</html>
